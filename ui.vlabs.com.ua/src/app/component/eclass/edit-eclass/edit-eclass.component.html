<mat-accordion>
    <mat-expansion-panel [expanded]="true">
        <mat-expansion-panel-header>
            <mat-panel-title class="styles-mat-panel-title-pad styles-not-selectable">
                EClass General Properties
            </mat-panel-title>
        </mat-expansion-panel-header>

        <mat-progress-spinner *ngIf="!completed" mode="indeterminate"></mat-progress-spinner>
        <form *ngIf="completed" [formGroup]="generalEClassFormGroup" (ngSubmit)="onGeneralEClassFormSubmit()" #generalEClassForm="ngForm">
          <mat-form-field class="styles-full-width">
            <input [(ngModel)]="eClass.title" matInput formControlName="title" type="text" placeholder="Title" required>
          </mat-form-field>
          <mat-form-field class="styles-full-width">
            <textarea [(ngModel)]="eClass.description" matInput formControlName="description" placeholder="Description" matTextareaAutosize matAutosizeMinRows="3" matAutosizeMaxRows="4"></textarea>
          </mat-form-field>
          <mat-checkbox [(ngModel)]="eClass.active" class="styles-full-width" matInput formControlName="active">EClass is active</mat-checkbox>

          <div class="styles-full-width" style="margin-top: 15pt; margin-bottom: 10pt;">
            <mat-form-field>
                <mat-select placeholder="EClass Format" formControlName="formatId" [(ngModel)]="eClass.formatId">
                    <mat-option *ngFor="let eclassFormat of eClassFormats" [value]="eclassFormat.id">
                        {{ eclassFormat.title }}
                    </mat-option>
                </mat-select>
            </mat-form-field>
          </div>

          Summary
          <quill [(value)]="eclassSummary"></quill>

          <div class="styles-mat-card-actions" style="margin-top:10pt;">
              <div style="display: block; float: left;" [class]="notification.msgType" *ngIf="notification" [innerHTML]="notification.msgBody"></div>
              <mat-progress-spinner style="display: inline-block; vertical-align:middle;" *ngIf="submitted" [diameter]="35" mode="indeterminate"></mat-progress-spinner>
              <button style="display: inline-block;" type="submit" mat-button [disabled]="!generalEClassForm.form.valid">UPDATE</button>
          </div>
        </form>
    </mat-expansion-panel>

    <mat-expansion-panel *ngIf="completed">
        <mat-expansion-panel-header (click)="eCLassStructureHeaderClicked($event)">
            <mat-panel-title class="styles-mat-panel-title-pad styles-not-selectable">
                EClass Structure
            </mat-panel-title>
            <mat-panel-description>
                <mat-progress-spinner style="display: inline-block; vertical-align:middle;" *ngIf="cElementSaving" [diameter]="35" mode="indeterminate"></mat-progress-spinner>
            </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-progress-spinner *ngIf="!structureCompleted" mode="indeterminate"></mat-progress-spinner>
        <div *ngIf="structureCompleted" style="min-height: 50vh;">
            <div style="display: table-cell; width: 100vw; text-align: right;">
                <button mat-button (click)="addCElement()">
                    <mat-icon class="md-18">add</mat-icon>
                    <span>Content Element</span>
                </button>
            </div>
            <!-- Content Elements -->
            <hr/>
            <div>
                <ul dnd-sortable-container [sortableData]="eClassStrcuture.cElements" style="list-style: none; padding: 0;">
                    <li *ngFor="let cElement of eClassStrcuture.cElements; let i = index" 
                        dnd-sortable [sortableIndex]="i" 
                        (onDropSuccess)="cElementDropped()"
                        style="padding:0 0 10pt 0;">
                        <mat-card>
                            <div class="styles-full-width">
                                <!-- CElement title -->
                                <div style="float: left;">
                                    <div style="float: left;">
                                        <mat-icon matTooltip="{{ cElement.type }}" class="md-36 celement">{{ cElement.type | celement : {action: 'icon'} }}</mat-icon>
                                    </div>
                                    <div (click)="cElementTitleEdit(cElement)" style="float: left; margin-left: 10pt; margin-top: 10%;">
                                        <div *ngIf="!cElement.title" style="color: grey; float: left;">TITLE</div>
                                        <div *ngIf="cElement.title" style="float: left;">{{cElement.title}}</div>
                                        <mat-icon style="float: left; margin-left: 2pt;" class="md-18">mode_edit</mat-icon>
                                    </div>
                                </div>
                                <!-- CElement tools -->
                                <div style="float: right;">
                                    <mat-icon class="md-18" (click)="cElementSettings(cElement)">build</mat-icon>
                                </div>
                                <div style="clear: both;"></div>
                            </div>
                            <!-- CElement content -->
                            <mat-card-content>
                                CONTENT
                            </mat-card-content>
                        </mat-card>
                    </li>
                </ul>
            </div>
        </div>
    </mat-expansion-panel>

</mat-accordion>